import Joi from 'joi';
import { ValidationError } from './errors';

const validationMiddleware = (schema) => (req, res, next) => {
  const { error } = schema.validate(req.body);
  
  if (error) {
    throw new ValidationError(error.details);
  }
  
  next();
};

export const orderSchema = Joi.object({
  customerId: Joi.string().required(),
  items: Joi.array().items(
    Joi.object({
      productId: Joi.string().required(),
      quantity: Joi.number().integer().min(1).required()
    })
  ).required()
});

export default validationMiddleware;
