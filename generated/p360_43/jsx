import AccessControl from 'accesscontrol';

const ac = new AccessControl();
ac.grant('user')
  .readOwn('profile')
  .updateOwn('profile');

ac.grant('admin')
  .extend('user')
  .readAny('profile')
  .updateAny('profile');

function authorizeUser(userId, resource, action) {
  const permission = ac.can(userId).execute(action).on(resource);
  if (!permission.granted) {
    throw new Error('Unauthorized');
  }
}
